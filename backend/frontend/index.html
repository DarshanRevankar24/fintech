<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Portfolio Explainer</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="background-orbs">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <!-- Auth Modal -->
    <div id="auth-modal" class="auth-modal glass-panel">
        <h2 class="gradient-text" id="auth-title">Log In to AI Portfolio</h2>
        <p id="auth-subtitle">Analyze, save, and manage your investments.</p>

        <form id="auth-form">
            <div class="form-group" id="name-group" style="display: none;">
                <label>Full Name</label>
                <input type="text" id="auth-fullname" class="table-input" placeholder="e.g. Satoshi Nakamoto">
            </div>
            <div class="form-group" id="email-group" style="display: none;">
                <label>Email Address</label>
                <input type="email" id="auth-email" class="table-input" placeholder="satoshi@bitcoin.org">
            </div>
            <div class="form-group">
                <label>Username</label>
                <input type="text" id="auth-username" class="table-input" required placeholder="Choose a username">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="auth-password" class="table-input" required placeholder="••••••••">
            </div>

            <button type="submit" class="btn btn-action" id="auth-submit-btn">Log In</button>
        </form>

        <p class="auth-switch">
            <span id="auth-switch-text">Don't have an account?</span>
            <a href="#" id="auth-switch-link">Register here</a>
        </p>
    </div>

    <!-- Main App Container (Hidden until logged in) -->
    <div class="container hidden" id="app-container">
        <header>
            <div class="header-top" style="display: flex; justify-content: space-between; align-items: center;">
                <h1 class="gradient-text"><i class="fa-solid fa-chart-line"></i> AI Portfolio Analyzer</h1>
                <div class="user-badge" style="display: flex; gap: 1rem; align-items: center;">
                    <span id="welcome-name" style="font-weight: 600;"></span>
                    <button id="logout-btn" class="btn btn-outline btn-sm"><i
                            class="fa-solid fa-arrow-right-from-bracket"></i> Logout</button>
                </div>
            </div>
            <p>Enter your portfolio details to get a real-time, personalized financial explanation.</p>
        </header>

        <!-- Upload Section -->
        <main id="upload-section" class="glass-panel">
            <div class="manual-entry-area" id="manual-entry">
                <h3><i class="fa-solid fa-pen-to-square"></i> Enter Portfolio Holdings</h3>
                <p>Add your stock tickers, shares, and purchase details below. We'll fetch real-time prices
                    automatically.</p>

                <div class="table-container">
                    <table id="portfolio-table">
                        <thead>
                            <tr>
                                <th>Ticker Symbol</th>
                                <th>Shares Owned</th>
                                <th>Purchase Price ($)</th>
                                <th>Purchase Date</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="portfolio-body">
                            <!-- Rows will be added here dynamically -->
                        </tbody>
                    </table>
                </div>

                <button class="btn btn-outline" id="add-row-btn" style="margin-top: 1rem;">
                    <i class="fa-solid fa-plus"></i> Add Holding
                </button>
            </div>

            <div class="settings-grid">
                <div class="setting-item">
                    <label for="user-level"><i class="fa-solid fa-user-graduate"></i> Expertise Level</label>
                    <select id="user-level">
                        <option value="beginner" selected>Beginner - Keep it simple</option>
                        <option value="intermediate">Intermediate - Standard terms</option>
                        <option value="expert">Expert - Data & Metrics</option>
                    </select>
                </div>

                <div class="setting-item checkbox-wrap">
                    <label class="toggle">
                        <input type="checkbox" id="include-tax" checked>
                        <span class="slider"></span>
                    </label>
                    <span class="toggle-label"><i class="fa-solid fa-file-invoice-dollar"></i> Include Tax
                        Analysis</span>
                </div>

                <div class="setting-item checkbox-wrap">
                    <label class="toggle">
                        <input type="checkbox" id="include-rebalance" checked>
                        <span class="slider"></span>
                    </label>
                    <span class="toggle-label"><i class="fa-solid fa-scale-balanced"></i> Suggest Rebalancing</span>
                </div>
            </div>

            <button id="analyze-btn" class="btn btn-action" disabled>
                <i class="fa-solid fa-wand-magic-sparkles"></i> Analyze Portfolio
            </button>
        </main>

        <!-- Loading Section -->
        <div id="loading-section" class="hidden glass-panel loading-panel">
            <div class="spinner"></div>
            <h3 class="gradient-text" id="loading-text">Fetching live prices...</h3>
            <div class="progress-bar-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
        </div>

        <!-- Dashboard / Results Section -->
        <section id="result-section" class="hidden">
            <!-- Top Stats -->
            <div class="stats-grid">
                <div class="stat-card glass-panel">
                    <div class="stat-icon"><i class="fa-solid fa-wallet"></i></div>
                    <div class="stat-info">
                        <p>Total Value (Live)</p>
                        <h2 class="gradient-text" id="total-value">$0.00</h2>
                    </div>
                </div>
                <div class="stat-card glass-panel">
                    <div class="stat-icon"><i class="fa-solid fa-arrow-trend-up"></i></div>
                    <div class="stat-info">
                        <p>Unrealized Gain</p>
                        <h2 id="total-gain">$0.00 (0.0%)</h2>
                    </div>
                </div>
                <div class="stat-card glass-panel">
                    <div class="stat-icon"><i class="fa-solid fa-crown"></i></div>
                    <div class="stat-info">
                        <p>Top Position</p>
                        <h2 id="top-position">AAPL (0%)</h2>
                    </div>
                </div>
            </div>

            <!-- Analysis & Chart Row -->
            <div class="main-content-grid">
                <div class="explanation-card glass-panel">
                    <h3><i class="fa-solid fa-robot"></i> AI Assessment</h3>
                    <div id="ai-explanation" class="markdown-body">
                        <!-- AI Explanation injected here -->
                    </div>
                </div>

                <div class="chart-card glass-panel">
                    <h3><i class="fa-solid fa-chart-pie"></i> Sector Allocation</h3>
                    <div class="chart-container">
                        <canvas id="sectorChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Pros/Cons Row -->
            <div class="pros-cons-grid">
                <div class="glass-panel strengths">
                    <h3><i class="fa-regular fa-thumbs-up"></i> Key Strengths</h3>
                    <ul id="strengths-list"></ul>
                </div>
                <div class="glass-panel risks">
                    <h3><i class="fa-solid fa-triangle-exclamation"></i> Risks & Concerns</h3>
                    <ul id="risks-list"></ul>
                </div>
            </div>

            <!-- Tax Impact & Rebalancing -->
            <div class="bottom-grid">
                <div class="glass-panel tax-panel hidden" id="tax-panel">
                    <h3><i class="fa-solid fa-money-bill-transfer"></i> Estimated Tax Impact</h3>
                    <div class="table-container">
                        <table id="tax-table">
                            <thead>
                                <tr>
                                    <th>Asset</th>
                                    <th>Gain/Loss</th>
                                    <th>Type</th>
                                    <th>Est. Tax</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <div class="glass-panel rebalance-panel hidden" id="rebalance-panel">
                    <h3><i class="fa-solid fa-shuffle"></i> Rebalancing Ideas</h3>
                    <div id="rebalance-list" class="rebalance-list">
                        <!-- Rebalancing cards injected here -->
                    </div>
                </div>
            </div>

            <div class="action-row">
                <button class="btn btn-outline" onclick="window.location.reload()"><i
                        class="fa-solid fa-rotate-right"></i> Analyze Another Portfolio</button>
            </div>
        </section>

    </div>

    <script src="script.js"></script>
</body>

</html>